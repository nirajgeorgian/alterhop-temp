{"version":3,"sources":["../../src/controller/auth.controller.js"],"names":["signup","req","res","data","body","user","UserModel","hashPassword","save","send","login","findOne","username","verified","verifyPassword","password","token","jwt","sign","id","email","process","env","JWT_SECRET","expiresIn"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AACA;;;;;;;;AAEO,IAAMA;AAAA,oEAAS,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AACfC,UADe,GACRF,IAAIG,IADI;AAEfC,UAFe,GAER,IAAIC,cAAJ,CAAcH,IAAd,CAFQ;;AAGrBE,WAAKE,YAAL;AAHqB;AAAA,aAIfF,KAAKG,IAAL,EAJe;;AAAA;AAAA,uCAKdN,IAAIO,IAAJ,CAAS,wBAAS,IAAT,EAAeJ,IAAf,CAAT,CALc;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAT;;AAAA;AAAA;AAAA;AAAA,GAAN;;AAQA,IAAMK;AAAA,qEAAQ,kBAAOT,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AACdC,UADc,GACPF,IAAIG,IADG;AAEdC,UAFc,GAEPC,eAAUK,OAAV,CAAkB,EAAEC,UAAUT,KAAKS,QAAjB,EAAlB,CAFO;;AAAA,UAGhBP,IAHgB;AAAA;AAAA;AAAA;;AAAA,wCAIZ,wBAAS,KAAT,4BAAuCA,KAAKO,QAA5C,CAJY;;AAAA;AAMdC,cANc,GAMHR,KAAKS,cAAL,CAAoBX,KAAKY,QAAzB,CANG;;AAAA,UAOhBF,QAPgB;AAAA;AAAA;AAAA;;AAAA,wCAQZ,wBAAS,KAAT,6CAAyDV,KAAKY,QAA9D,CARY;;AAAA;AAUdC,WAVc,GAUNC,uBAAIC,IAAJ,CAAS;AACtBC,WAAId,KAAKc,EADa;AAEtBC,cAAOf,KAAKe,KAFU;AAGtBR,iBAAUP,KAAKO;AAHO,OAAT,EAIXS,QAAQC,GAAR,CAAYC,UAJD,EAIa,EAAEC,WAAW,IAAb,EAJb,CAVM;AAAA,wCAebtB,IAAIO,IAAJ,CAAS,wBAAS,IAAT,EAAeO,KAAf,CAAT,CAfa;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAR;;AAAA;AAAA;AAAA;AAAA,GAAN","file":"auth.controller.js","sourcesContent":["import jwt from 'jsonwebtoken'\nimport UserModel from '../models/user.model'\nimport response from '../util/response.response'\n\nexport const signup = async (req, res) => {\n\tconst data = req.body\n\tconst user = new UserModel(data)\n\tuser.hashPassword()\n\tawait user.save()\n\treturn res.send(response(true, user))\n}\n\nexport const login = async (req, res) => {\n\tconst data = req.body\n\tconst user = UserModel.findOne({ username: data.username })\n\tif(!user) {\n\t\treturn response(false, `No User exist's for ${user.username}`)\n\t}\n\tconst verified = user.verifyPassword(data.password)\n\tif(!verified) {\n\t\treturn response(false, `Sorry the password did not matched:=> ${data.password}`)\n\t}\n\tconst token = jwt.sign({\n\t\tid: user.id,\n\t\temail: user.email,\n\t\tusername: user.username\n\t}, process.env.JWT_SECRET, { expiresIn: '1h' })\n\treturn res.send(response(true, token))\n}\n"]}